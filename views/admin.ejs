<%- include('meta', { currentPage: 'admin' }) %>
<%- include('header') %>

<main role="main">
    <div class="admin-container container">
        <div class="admin-header">
            <h1 class="admin-title"><%= title %></h1>
            <div>
                <a href="/admin/add" class="btn btn-primary">Add New Post</a>
                <a class="btn btn-danger" id="logoutBtn" href="/logout">Logout</a>
            </div>
        </div>

        <div id="mainContent">
            <div class="mb-4 d-flex justify-content-between align-items-center">
                <div></div>
                <div class="post-count">Total Posts: <%= posts.length %></div>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Content</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% posts.forEach(post => { %>
                            <tr>
                                <td><%= post.title %></td>
                                <td><%= post.content.replace(/<\/?[^>]+(>|$)/g, "").substring(0, 130) %><%= post.content.length > 130 ? '...' : '' %></td>
                                <td>
                                    <a href="/admin/edit?postId=<%= post.id %>" class="btn btn-warning btn-sm">Edit</a>
                                    <a href="/admin/delete/<%= post.id %>" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this post?');">Delete</a>
                                </td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        </div>

        <a href="/" class="btn btn-secondary back-btn">Back to Home</a>
    </div>
</main>

<%- include('footer') %>